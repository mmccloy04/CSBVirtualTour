<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="https://cdn.glitch.global/189c5b32-4e8b-4e96-b443-5aae4d110245/qublogo.png?v=1706269760196" /> <!--Queens logo sourced from https://www.stickpng.com/img/icons-logos-emojis/russell-group-universities/queens-university-belfast-logo -->
    <title>EEECS VR Tour</title>
    <link rel="stylesheet" href="/css/style.css" />
    <script src="../../../js/script.js"></script>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.misc.min.js"></script> <!-- script for hand controls and animation sourced from https://www.youtube.com/watch?v=vQ85u3dzmZY and https://github.com/c-frame/aframe-super-hands-component-->
    <script src="https://unpkg.com/super-hands@^3.0.3/dist/super-hands.min.js"></script> <!-- script for superhands sourced from https://github.com/c-frame/aframe-super-hands-component-->
    <script src="https://unpkg.com/aframe-event-set-component@5.x.x/dist/aframe-event-set-component.min.js"></script> <!-- script for event set component sourced from https://aframe.io/docs/1.5.0/guides/building-a-360-image-gallery.html -->
    
    <script src="../../../js/aframe-keyboard.min.js"></script> <!--keyboard script sourced from https://github.com/WandererOU/aframe-keyboard/tree/master/dist -->
    
    <!-- CUSTOM COMPONENT
    Registering a custom component to have one entity face another entity (used to make objects face the user)
    Sourced from https://stackoverflow.com/questions/66508949/a-frame-make-model-face-the-viewer-center-of-the-screen-or-canvas -->
    <script>
      AFRAME.registerComponent("look-at", {
        schema: { type: "selector" },

        init: function () {},

        tick: function () {
          this.el.object3D.lookAt(this.data.object3D.position);
        },
      });
    </script>
    
    <!--CONTROLLER COMPONENT
    Used to support all the controller components, while providing the hand and overriding the model.
    Sourced from aframe.io/docs/1.5.0/introduction/interactions-and-controllers.html#creating-custom-controllers -->
    <script>
      AFRAME.registerComponent("custom-controls", {
        schema: {
          hand: { default: "" },
          model: { default: "customControllerModel.gltf" },
        },
        update: function () {
          var hand = this.data.hand;
          var el = this.el;
          var controlConfiguration = {
            hand: hand,
            model: false,
            orientationOffset: { x: 0, y: 0, z: hand === "left" ? 90 : -90 },
          };
          // Build on top of controller components.
          el.setAttribute("vive-controls", controlConfiguration);
          el.setAttribute("oculus-touch-controls", controlConfiguration);
          el.setAttribute("windows-motion-controls", controlConfiguration);
          // Set a model.
          el.setAttribute("gltf-model", this.data.model);
        },
      });
    </script>
    
     
        <!--COMPONENT TO ALLOW BOXES TO HAVE DIFFERENT IMAGES ON EACH SIDE
    Adapted/sourced from: https://stackoverflow.com/questions/69339884/a-frame-is-there-a-way-to-make-an-image-show-up-on-only-one-side-of-a-shape -->
    <script>

  AFRAME.registerComponent("box-side-img", {
    schema: {
      img: {type: "selector"}
    },
    init: function() {
      // wait until the entity is loaded
      this.el.addEventListener("loaded", evt => {
        // grab the mesh
        const mesh = this.el.getObject3D("mesh");
        // load the texture
        this.el.sceneEl.systems.material.loadTexture(this.data.img, {
            src: this.data.img
          },
          // when loaded, create 6 materials for each side
          function textureLoaded(texture) {
            var cubeMaterial = [
              new THREE.MeshBasicMaterial({map: texture}),
              new THREE.MeshBasicMaterial({color: 'white'}),
              new THREE.MeshBasicMaterial({color: '#222222'}),
               new THREE.MeshBasicMaterial({color: '#222222'}),
              new THREE.MeshBasicMaterial({olor: '##222222'}),
              new THREE.MeshBasicMaterial({color: '#222222'})
            ];
            // apply the new material + clean up the old one
            var oldMaterial = mesh.material;
            mesh.material = cubeMaterial;
            oldMaterial.dispose()
          });
      });
    }
  })
    </script>
      
  </head>

  <body>
    <a-scene>
      
      <!--ASSETS-->
      <a-assets>
        <!--assets for icons
        password icon sourced from https://www.vectorstock.com/royalty-free-vector/password-icon-vector-733219 -->
        <img id="audio_icon" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/audio.png?v=1706309195931">
        <img id="task_icon" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/task5.png?v=1706309028596">
        <img id="password_icon" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/password-icon-vector-733219.jpg?v=1706646001396">        
        
        <!--360 images for locations-->
        <img id="c1_image" src="https://cdn.glitch.global/0ecceb09-097f-4efc-83ce-6923956c956e/034_corridor_techniciansdesk.jpg?v=1698967209660">
        <img id="c2_image" src="https://cdn.glitch.global/0ecceb09-097f-4efc-83ce-6923956c956e/019_computerlab_empty.jpg?v=1698968671284">
        <img id="g6_image" src="https://cdn.glitch.global/0ecceb09-097f-4efc-83ce-6923956c956e/021_foyertoilets_doorclosed_doortolab.jpg?v=1698966414094">
        
        <!-- assets for interactive scenarios 
        The screenshots of QSIS were sourced/adapted from https://qsis.qub.ac.uk/psp/cs92prd/?cmd=login&languageCd=ENG& 
        and the timetable in the screen3_image was provided by Tricia Oâ€™Reilly-->
        <img id="password_image" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/password2.png?v=1706645371908">
        <img id="computer_image" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/computer.png?v=1706394419674">
        <img id="screen1_image" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/screen1.png?v=1706404625247">
        <img id="screen2_image" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/screen2.png?v=1706404632328">
        <img id="screen3_image" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/screen3.png?v=1706452396829">
        <img id="classes_icon" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/class.png?v=1706455061761">
        <img id="timetable_icon" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/timetable.png?v=1706455066289">
      </a-assets>

      <!--CAMERA AND CONTROLS-->
      <a-entity>
        <a-camera position="1 1 0" id="myCamera" cursor="rayOrigin: mouse"></a-camera>
        <a-entity sphere-collider="objects: a-plane, a-box, a-sphere" super-hands hand-controls="hand: right"></a-entity>  <!-- Right hand implements hand controls with superhands, adapted/sourced from https://github.com/c-frame/aframe-super-hands-component -->
        <a-entity oculus-touch-controls="hand: left" thumbstick-logging></a-entity> <!--Left hand is the controller, adapted/sourced from https://aframe.io/docs/1.5.0/components/oculus-touch-controls.html -->
        <a-entity laser-controls="hand: left"></a-entity> <!--Left hand (controller) has laser, adapted/sourced from https://aframe.io/docs/1.5.0/components/laser-controls.html -->
      </a-entity>
      
      
      <!--BACKGROUND-->
      <a-sky src="#c2_image" rotation="0 -130 0" zoom="0.8"></a-sky>
      
      <!--SPHERES LINKING TO OTHER LOCATIONS -->
      <a-sphere id="g6" position="4.4 1.3 -11" radius="1" src="#g6_image"
        event-set__enter="_event: mouseenter; scale: 1.2 1.2 1.2"
        event-set__leave="_event: mouseleave; scale: 1 1 1">
        <a-text font="kelsonsans" value="This way to the\nGround Floor Foyer" width="7" position="0 -1.5 0" align="center" look-at="#myCamera"></a-text>
      </a-sphere>
      
      <!--OBJECTS FOR VIDEOS/AUDIO-->
      <a-box id="audioimg" position="-1.8 0.5 -9" src="#audio_icon"
        event-set__enter="_event: mouseenter; _target: #audioText; visible: true"
        event-set__leave="_event: mouseleave; _target: #audioText; visible: false">
         <a-text id="audioText" value="Click and hold to hear what it sounds like in the Computer Lab." align="center" color="#FFFFFF" width="7" font="kelsonsans" 
        visible="false" position="0.05 1.5 -0.05" geometry="primitive: plane; height: 0; width: 0" material="color: #333333" look-at="#myCamera"></a-text>
      </a-box> 
      
      <!-- INTERACTIVE SCENARIOS-->
      
      <!--TASK
      alternative position 1 -0.5 -6-->
      <a-box id="task" position="7 1.3 0" src="#task_icon" 
        event-set__enter="_event: mouseenter; _target: #taskText; visible: true"
        event-set__leave="_event: mouseleave; _target: #taskText; visible: false">
        <a-text id="taskText" value="Your task is to logon to a computer -\nclick on the task box below to get started.\n(Hint: you can grab the computer/keyboard with your right hand to move them!)." align="center" color="#FFFFFF" width="7" font="kelsonsans" 
        visible="false" position="0.05 1.6 -0.05" geometry="primitive: plane; height: 0; width: 0" material="color: #333333" look-at="#myCamera"></a-text>
      </a-box>
      
      <!--PASSWORD BOX-->
      <a-box id="password" position="7 0 0" color="blue" rotation="0 180 0"
          animation__mousedown="property: rotation; to: 0 0 0 ; dur: 1000; startEvents: mousedown" 
          box-side-img="img: #password_icon" visible="false" >
        <a-text value="EEECS_\nlab123" width="5" align="center" position="-0.7 0 0" color="black" look-at="#myCamera"></a-text>
      </a-box>
      
      
      <!--COMPUTER SCREEN AND KEYBOARD (GRABBABLE)
      Keyboard sourced/adapted from https://wandererou.github.io/aframe-keyboard/ and https://wandererou.github.io/aframe-keyboard/examples/basic/index.html -->
      <a-plane id ="computer"
          grabbable draggable droppable
          position="4 2.5 9" width="14" height="9" src="#computer_image" 
          animation="property=rotation; from: 0 0 0; to 360 360 0; dur:20000; startEvents:click;"
          look-at="#myCamera" visible="false">
         <a-plane id="screen" position="0.01 0 0.01" width="13.7" height="8.7" src="#screen1_image"></a-plane>
         <a-text id="input" font="kelsonsans" value="Enter your password..." width="4" position="-2.5 -1.6 1" text="" color="#000000"></a-text>
         <a-entity id="keyboard" position="-4.8 -4 3"  scale="20 20 20" rotation="-40 0 0" a-keyboard=""></a-entity>
        
         <!--Instructions-->
         <a-text id="instructions" font="kelsonsans" value="Click on the password icon (beneath the task box) to reveal your password. Then enter your password and select 'Submit'."
            align="center" color="#FFFFFF" width="8" position="0 5 1" 
            geometry="primitive: plane; height: 1.5; width: 12" visible="true"></a-text>
        
        <a-plane id="classes" position="2.6 -1 0.5" width="2.4" height="2" src="#classes_icon" visible="false"
            event-set__enter="_event: mouseenter; scale: 2 2 2"
            event-set__leave="_event: mouseleave; scale: 1 1 1">
        </a-plane>
        
        <a-plane id="timetable" position="-0.2 -3.3 0.5" width="1.2" height="1.2" src="#timetable_icon" visible="false"
            event-set__enter="_event: mouseenter; scale: 3 3 3" 
            event-set__leave="_event: mouseleave; scale: 1 1 1">
        </a-plane>
        
        <a-plane id="task2" position="5 -3 0.5" width="2" height="1.5" src="#task_icon" visible="false"
           event-set__enter="_event: mouseenter; _target: #task2Text; visible: true"
            event-set__leave="_event: mouseleave; _target: #task2Text; visible: false">
            <a-text id="task2Text" value="Your next task is to go to your lecture\nin Lecture Hall 02/027.\n(Hint: '02' indicates it is on the Second Floor,\nso you will need to take the stairs or the lift)." 
                    align="center" color="#FFFFFF" width="8" font="kelsonsans" 
                    visible="false" position="0 1.6 -0.05" geometry="primitive: plane; height: 0; width: 0" material="color: #333333"></a-text>
        </a-plane>
        
      </a-plane>
      
      
  
    </a-scene>
  </body>

  <!--NAVIGATE TO OTHER PAGES (LOCATIONS/VIDEOS) -->  
  <script> 
    document
      .querySelector("#g6")
      .addEventListener("click", e => {
        location.href = "g6.html";
    });
    
   <!--SHOW COMPUTER, KEYBOARD AND PASSWORD BOX WHEN CLICK TASK BOX-->
    document
      .querySelector("#task")
      .addEventListener("click", e => {
        document.querySelector('#computer').setAttribute('visible', 'true') 
        document.querySelector('#password').setAttribute('visible', 'true') 
    });
   <!--SHOW SCREEN 3 WHEN CLICK CLASSES BOX-->
    document
      .querySelector("#classes")
      .addEventListener("click", e => {
        document.querySelector('#screen').setAttribute('src', '#screen3_image') /* change to timetable screen */
        document.querySelector('#instructions').setAttribute('value', 'Your next class is outlined in black below. Hover over this class to find out the location.') /* update instructions */
        document.querySelector('#classes').setAttribute('visible', 'false') /* hide classes icon */
        document.querySelector('#timetable').setAttribute('visible', 'true') /* show timetable icon */
        document.querySelector('#task2').setAttribute('visible', 'true') /* show next task box */
    });
  </script>
  
  <!-- PLAY/PAUSE AUDIO (stops playing audio once release mouse)
    Audio file with event listener, sourced/adapted from https://stackoverflow.com/questions/69470562/how-do-i-get-audio-to-play-when-i-hover-over-an-image -->
  <script>
    const audioFile = ['https://cdn.glitch.global/8cefb064-2b3f-4ee6-95b2-81aed480e217/202%20Computer%20Lab.mp3?v=1701451048932'
    ];
    var audioimg = document.getElementById("audioimg");
    const audio = new Audio(audioFile);
    function play() {
      audio.play();
    }
    function stop() {
      audio.pause();
    }
    audioimg.addEventListener('mousedown', play);
    audioimg.addEventListener('mouseup', stop);
  </script>
    

  <!-- PROCESS KEYBOARD INPUT
  Example sourced/adapted from https://wandererou.github.io/aframe-keyboard/ and https://wandererou.github.io/aframe-keyboard/examples/basic/index.html 
  key codes - 06 is submit, 8 is delete, 13 is enter, 16 is shift, 18 is alt -->
  <script>
  var input = ''
  function updateInput(e) {
    var code = parseInt(e.detail.code)
    switch(code) { 
    /* 8 is the delete key which takes 1 off the input */
    case 8:
      input = input.slice(0, -1)
      break
    /* 06 is the submit key */
    case 06:
      var keyboard = document.querySelector('#keyboard')
      document.querySelector('#input').setAttribute('value', input)
    
        /* ADDED IN TO VERIFY PASSWORD */
      /* Creating a cookie using javascript, will later read the cookie in PHP
      Sourced/adapted from: https://stackoverflow.com/questions/21620133/how-to-assign-javascript-variable-value-to-php-variable  */
      /* document.cookie = "myJavascriptVar = " + myJavascriptVar  add code to assign submitted input to variable to pass to PHP */
      /* OR  document.cookie = "myJavascriptVar = #input"; */
      
        
      /*ADDED IN THE BELOW TO DETERMINE WHAT HAPPENS WHEN CORRECT PASSWORD SUBMITTED /*  
      /* document.querySelector('#input').setAttribute('color', 'grey') changed colour*/
      /*keyboard.parentNode.removeChild(keyboard)     hides keyboard after pressing submit */
      alert('Login Successful')
      document.querySelector('#input').setAttribute('visible', 'false') /* hide input box */
      document.querySelector('#screen').setAttribute('src', '#screen2_image') /* change to QSIS screen */
      document.querySelector('#classes').setAttribute('visible', 'true') /* show classes icon */
      document.querySelector('#instructions').setAttribute('value', 'This is your QSIS homepage. Select the \'Classes\' icon to view your timetable.') /* update instructions */
      
      return
    /* default is to return the value of the selected key and add it to the input */
    default:
      input = input + e.detail.value
      break
    }
    document.querySelector('#input').setAttribute('value', input + '_')
  }
  document.addEventListener('a-keyboard-update', updateInput)
  </script>
  
  
  <!-- PHP CODE TO RETRIEVE JS VARIABLE 
  Sourced/adapted from: https://stackoverflow.com/questions/21620133/how-to-assign-javascript-variable-value-to-php-variable
  <?php
      $myPhpVar= $_COOKIE['myJavascriptVar'];
      echo $phpVar;
  ?>
  -->
    
 
</html>

