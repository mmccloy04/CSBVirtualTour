<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="icon" href="https://cdn.glitch.global/189c5b32-4e8b-4e96-b443-5aae4d110245/qublogo.png?v=1706269760196" /> <!--Queens logo sourced from https://www.stickpng.com/img/icons-logos-emojis/russell-group-universities/queens-university-belfast-logo -->
    <title>EEECS VR Tour</title>
    <link rel="stylesheet" href="/css/style.css" />
    <script src="../../../js/script.js"></script>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.misc.min.js"></script> <!-- script for hand controls and animation sourced from https://www.youtube.com/watch?v=vQ85u3dzmZY and https://github.com/c-frame/aframe-super-hands-component-->
    <script src="https://unpkg.com/super-hands@^3.0.3/dist/super-hands.min.js"></script> <!-- script for superhands sourced from https://github.com/c-frame/aframe-super-hands-component-->
    <script src="https://unpkg.com/aframe-event-set-component@5.x.x/dist/aframe-event-set-component.min.js"></script> <!-- script for event set component sourced from https://aframe.io/docs/1.5.0/guides/building-a-360-image-gallery.html -->

    <!-- CUSTOM COMPONENT
    Registering a custom component to have one entity face another entity (used to make objects face the user)
    Sourced from https://stackoverflow.com/questions/66508949/a-frame-make-model-face-the-viewer-center-of-the-screen-or-canvas -->
    <script>
      AFRAME.registerComponent("look-at", {
        schema: { type: "selector" },

        init: function () {},

        tick: function () {
          this.el.object3D.lookAt(this.data.object3D.position);
        },
      });
    </script>
    
    <!--CONTROLLER COMPONENT
    Used to support all the controller components, while providing the hand and overriding the model.
    Sourced from aframe.io/docs/1.5.0/introduction/interactions-and-controllers.html#creating-custom-controllers -->
    <script>
      AFRAME.registerComponent("custom-controls", {
        schema: {
          hand: { default: "" },
          model: { default: "customControllerModel.gltf" },
        },
        update: function () {
          var hand = this.data.hand;
          var el = this.el;
          var controlConfiguration = {
            hand: hand,
            model: false,
            orientationOffset: { x: 0, y: 0, z: hand === "left" ? 90 : -90 },
          };
          // Build on top of controller components.
          el.setAttribute("vive-controls", controlConfiguration);
          el.setAttribute("oculus-touch-controls", controlConfiguration);
          el.setAttribute("windows-motion-controls", controlConfiguration);
          // Set a model.
          el.setAttribute("gltf-model", this.data.model);
        },
      });
    </script>
    
  </head>

  <body>
    <a-scene>
      
      <!--ASSETS-->
      <a-assets>
        <!--assets for icons-->
        <img id="audio_icon" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/audio.png?v=1706309195931">
        <img id="task_icon" src="https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/task5.png?v=1706309028596">
        
        <!--360 images for locations-->
        <img id="q1_image" src="https://cdn.glitch.global/0ecceb09-097f-4efc-83ce-6923956c956e/044_corridor1_canjustseelab.jpg?v=1699107303962">
      </a-assets>

      <!--CAMERA AND CONTROLS-->
      <a-entity>
        <a-camera position="1 1 0" id="myCamera" cursor="rayOrigin: mouse"></a-camera>
        <a-entity sphere-collider="objects: a-plane, a-box, a-sphere" super-hands hand-controls="hand: right"></a-entity>  <!-- Right hand implements hand controls with superhands, adapted/sourced from https://github.com/c-frame/aframe-super-hands-component -->
        <a-entity oculus-touch-controls="hand: left" thumbstick-logging></a-entity> <!--Left hand is the controller, adapted/sourced from https://aframe.io/docs/1.5.0/components/oculus-touch-controls.html -->
        <a-entity laser-controls="hand: left"></a-entity> <!--Left hand (controller) has laser, adapted/sourced from https://aframe.io/docs/1.5.0/components/laser-controls.html -->
      </a-entity>
      
      <!--BACKGROUND-->
      <a-sky src="https://cdn.glitch.me/8cefb064-2b3f-4ee6-95b2-81aed480e217/q2video.mp4?v=1701474622591" rotation="0 60 0"></a-sky>
     
      <!--SPHERES LINKING TO OTHER LOCATIONS -->
      <a-sphere id="q1" position="4.5 1.5 9" radius="1" src="#q1_image"
        event-set__enter="_event: mouseenter; scale: 1.2 1.2 1.2"
        event-set__leave="_event: mouseleave; scale: 1 1 1">
        <a-text font="kelsonsans" value="This way to\nthe Corridor" width="7" position="0 -1.5 0" align="center" look-at="#myCamera"></a-text>
      </a-sphere>
      
      <!--OBJECTS FOR VIDEOS/AUDIO
      <a-box id="audioimg" src="#audio_icon" position="-8.5 2 -3.5"></a-box> -->
      
      <!--TASK (WITH AUDIO)-->
      <a-box id="task" position="-1.5 -0.5 -5" src="#task_icon" height="1"
        event-set__enter="_event: mouseenter; _target: #taskText; visible: true"
        event-set__leave="_event: mouseleave; _target: #taskText; visible: false">
        <a-text id="taskText" value="Well done for finding the Learning Lab!\n Unfortunately you can't stick around as the Fire Alarm has just started going off. Please exit the building via the stairs and head to the Fire Assembly Point outside.\n" 
                align="center" color="#FFFFFF" width="6" font="kelsonsans" 
                visible="false" position="0.05 2 -0.05" geometry="primitive: plane; width: 8; height: 2;" material="color: #333333" look-at="#myCamera"></a-text>
      </a-box>
      
      <!-- INTERACTIVE SCENARIOS-->
      
    </a-scene>
  </body>

  <!--NAVIGATE TO OTHER PAGES (LOCATIONS/VIDEOS) -->  
  <script> 
    document
      .querySelector("#q1")
      .addEventListener("click", e => {
        location.href = "q1.html";
    });
    

  </script>
  
  <!-- PLAY/PAUSE AUDIO (stops playing audio once release mouse)
  Audio file with event listener, sourced/adapted from https://stackoverflow.com/questions/69470562/how-do-i-get-audio-to-play-when-i-hover-over-an-image 
  Fire alarm audio clip downloaded from https://pixabay.com/sound-effects/search/fire-alarm/ -->
  <script>
    const audioFile = ['https://cdn.glitch.global/943a3cf6-3872-4e08-b494-74ea4b0fdad8/201%20Fire%20Alarm%20v2.mp3?v=1706457521803'
    ];
    var audioimg = document.getElementById("task");
    const audio = new Audio(audioFile);
    function play() {
      audio.play();
    }
    function stop() {
      audio.pause();
    }
    audioimg.addEventListener('mouseenter', play);
    audioimg.addEventListener('mouseleave', stop);
  </script>
 
</html>
